{% extends "base.html" %}
{% load socialaccount static %}
{% block title %}
    {{ requested_user|title }}'s profile
{% endblock %}
{% block content %}
    {% get_social_accounts requested_user as accounts %}
    <div class="flex w-full flex-col space-y-20 px-4 mt-4">
        <div class="profile flex space-x-5 mx-auto items-center">
            {% if accounts %}
                {% with account=accounts.discord.0 %}
                    <div class="profile_banner flex flex-col justify-center items-center text-sm px-2  py-4 gap-y-2  rounded-lg text-bf2042-4">
                        <div class="w-28">
                        {% if account.extra_data.avatar %}
                            <img src="{{ account.get_avatar_url }}" class="block rounded-full mx-auto" alt="@p"/>
                        {% else %}
                            <img src="{% static 'images/default_discord_avatar.png' %}" class="block rounded-full mx-auto" alt="@p"/>
                        {% endif %}
                        </div>
                        <div class="flex flex-col text-white font-bold gap-y-2">
                            <div class="text-center">
                               {{ account.extra_data.username }}<p class="inline text-gray-400">#{{ account.extra_data.discriminator }}</p>
                            </div>
                            {% if account.extra_data.id in owners %}
                                <div>
                                   <p class="text-center text-bf2042-5">Owner</p>
                                </div>
                            {% else %}
                                {% if requested_user.is_superuser %}
                                <div>
                                   <p class="text-center text-red-600">Administrator</p>
                                </div>
                                {% elif requested_user|check_permission:"wagtailadmin.access_admin" %}
                                <div>
                                   <p class="text-center text-red-400">Moderator</p>
                                </div>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <div class="user_info grid grid-cols-3 pr-4 text-white text-xs gap-x-3 gap-y-6">
                        <div class="flex flex-col gap-y-2">
                            <p class="font-semibold font-semibold">Account Create on</p>
                            <p class="text-bf2042-4">{{ user.date_joined|date:"d M Y"}}</p>
                        </div>
                        <div class="flex flex-col gap-y-2">
                            <p class="font-semibold font-semibold">Number of Experiences</p>
                            <a href="experiences/" class="text-bf2042-4 hover:text-bf2042-6">{{ total_num_posts  }}</a>
                        </div>
                        <div class="flex flex-col gap-y-2">
                            <p class="font-semibold  font-semibold">Likes Earned</p>
                            <p class="text-bf2042-4">{{earned_likes}}</p>
                        </div>
                    {% if latest_post %}
                        <div class="flex flex-col gap-y-2">
                            <p class="font-semibold  font-semibold">Latest Experience</p>
                                <a href="{{ latest_post.url }}" class="text-bf2042-4 hover:text-bf2042-6">{{ latest_post.title|title }} </a>
                        </div>
                        <div class="flex flex-col gap-y-2">
                            <p class="font-semibold  font-semibold">Posted On</p>
                            <p class="text-bf2042-4">{{ latest_post.first_published_at|date:"d M Y"}}</p>
                        </div>
                    {% endif %}
                    </div>
                {% endwith %}
            {% endif %}
        </div>
        {% include 'core/experiences_listing.html'%}
    </div>
{% endblock %}
